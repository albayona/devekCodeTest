{"ast":null,"code":"var _jsxFileName = \"/Users/andresbayona/Documents/DevekRepo/devekCodeTest/Frontend/devek/src/components/Chat/ChatInputBar.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState } from \"react\";\nimport { Box, TextField, IconButton } from \"@mui/material\";\nimport SendIcon from \"@mui/icons-material/Send\";\nimport { useSocket } from \"../../contexts/ChatRoomsContext\";\nimport { useAuth } from \"../../contexts/UserContext\";\nimport { API_HOST } from \"../../hooks/UseFetch\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nasync function fetchAPI(room, token, user, payload, logOut, endpoint = `${API_HOST}/groupchats/${room}/message/`, method = \"POST\") {\n  try {\n    const req = {\n      method: method,\n      headers: {\n        \"Authorization\": `Bearer ${token}`,\n        \"Content-Type\": \"application/json\",\n        \"X-Consumer-Custom-Id\": String(user)\n      }\n    };\n    if (method === 'POST' || method === 'PUT') {\n      req.body = JSON.stringify(payload);\n    }\n    const response = await fetch(endpoint, {\n      method: method,\n      headers: {\n        \"Authorization\": `Bearer ${token}`,\n        \"Content-Type\": \"application/json\",\n        \"X-Consumer-Custom-Id\": String(user)\n      },\n      body: JSON.stringify(payload)\n    });\n    if (response.status === 401) {\n      console.warn(\"Unauthorized request. Redirecting to login...\");\n      if (user !== null) {\n        logOut();\n      }\n      throw new Error(\"Unauthorized request. Redirecting to login...\");\n    }\n    if (!response.ok) {\n      throw new Error(`Error: ${response.statusText}`);\n    }\n    return await response.json();\n  } catch (error) {\n    console.error(\"Failed to send message:\", error);\n    return null;\n  }\n}\nconst ChatInputBar = ({\n  room,\n  scrollToBottom\n}) => {\n  _s();\n  const [message, setMessage] = useState(\"\");\n  const {\n    sendMessage\n  } = useSocket();\n  const {\n    user,\n    token,\n    logOut\n  } = useAuth();\n  const handleSend = async () => {\n    if (message.trim() !== \"\") {\n      const data = {\n        group: room,\n        name: user,\n        email: user,\n        text: message\n      };\n      sendMessage(data);\n      scrollToBottom();\n      setMessage(\"\");\n      const payload = {\n        text: message,\n        date: new Date().toISOString()\n      };\n      return await fetchAPI(room, token, user, payload, logOut);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(Box, {\n    sx: {\n      display: \"flex\",\n      alignItems: \"center\",\n      gap: 1,\n      // Spacing between elements\n      padding: 1,\n      backgroundColor: \"background.paper\",\n      borderTop: \"1px solid\",\n      borderColor: \"divider\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(TextField, {\n      fullWidth: true,\n      variant: \"outlined\",\n      placeholder: \"Type a message...\",\n      value: message,\n      onChange: e => setMessage(e.target.value),\n      onKeyDown: e => e.key === \"Enter\" && handleSend()\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n      color: \"primary\",\n      onClick: handleSend,\n      children: /*#__PURE__*/_jsxDEV(SendIcon, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 97,\n    columnNumber: 9\n  }, this);\n};\n_s(ChatInputBar, \"ijwJKkfsnuvnWOpP4HslWBE1W/w=\", false, function () {\n  return [useSocket, useAuth];\n});\n_c = ChatInputBar;\nexport default ChatInputBar;\nvar _c;\n$RefreshReg$(_c, \"ChatInputBar\");","map":{"version":3,"names":["React","useState","Box","TextField","IconButton","SendIcon","useSocket","useAuth","API_HOST","jsxDEV","_jsxDEV","fetchAPI","room","token","user","payload","logOut","endpoint","method","req","headers","String","body","JSON","stringify","response","fetch","status","console","warn","Error","ok","statusText","json","error","ChatInputBar","scrollToBottom","_s","message","setMessage","sendMessage","handleSend","trim","data","group","name","email","text","date","Date","toISOString","sx","display","alignItems","gap","padding","backgroundColor","borderTop","borderColor","children","fullWidth","variant","placeholder","value","onChange","e","target","onKeyDown","key","fileName","_jsxFileName","lineNumber","columnNumber","color","onClick","_c","$RefreshReg$"],"sources":["/Users/andresbayona/Documents/DevekRepo/devekCodeTest/Frontend/devek/src/components/Chat/ChatInputBar.tsx"],"sourcesContent":["import React, {useState} from \"react\";\nimport {Box, TextField, IconButton} from \"@mui/material\";\nimport SendIcon from \"@mui/icons-material/Send\";\nimport {useSocket} from \"../../contexts/ChatRoomsContext\";\nimport {MessageDTO} from \"../../contexts/ChatRoomsContext\";\nimport {useAuth} from \"../../contexts/UserContext\";\nimport {API_HOST} from \"../../hooks/UseFetch\";\n\n\ninterface ChatInputBarProps {\n    room: string,\n    scrollToBottom: () => void\n}\n\nasync function fetchAPI(room: string, token: string, user: string | null, payload: {\n    text: string;\n    date: string\n}, logOut: () => void, endpoint: any = `${API_HOST}/groupchats/${room}/message/`, method: string = \"POST\") {\n    try {\n\n        const req: RequestInit = {\n            method: method,\n            headers: {\n                \"Authorization\": `Bearer ${token}`,\n                \"Content-Type\": \"application/json\",\n                \"X-Consumer-Custom-Id\": String(user),\n            },\n        };\n\n        if (method === 'POST' || method === 'PUT') {\n            req.body = JSON.stringify(payload);\n        }\n\n\n\n        const response = await fetch(endpoint, {\n            method: method,\n            headers: {\n                \"Authorization\": `Bearer ${token}`,\n                \"Content-Type\": \"application/json\",\n                \"X-Consumer-Custom-Id\": String(user),\n            },\n            body: JSON.stringify(payload),\n        });\n\n        if (response.status === 401) {\n            console.warn(\"Unauthorized request. Redirecting to login...\");\n\n            if (user !== null) {\n                logOut();\n            }\n\n            throw new Error(\"Unauthorized request. Redirecting to login...\");\n        }\n\n        if (!response.ok) {\n            throw new Error(`Error: ${response.statusText}`);\n        }\n\n        return await response.json();\n    } catch (error) {\n        console.error(\"Failed to send message:\", error);\n        return null;\n    }\n}\n\nconst ChatInputBar: React.FC<ChatInputBarProps> = ({room, scrollToBottom}) => {\n    const [message, setMessage] = useState(\"\");\n    const {sendMessage} = useSocket();\n    const {user, token, logOut} = useAuth();\n\n    const handleSend = async () => {\n        if (message.trim() !== \"\") {\n\n            const data: MessageDTO = {group: room, name: user, email: user, text: message}\n            sendMessage(data);\n            scrollToBottom();\n            setMessage(\"\");\n\n\n            const payload = {\n                text: message,\n                date: new Date().toISOString(),\n            };\n\n\n            return await fetchAPI(room, token, user, payload, logOut);\n\n\n        }\n\n\n    };\n\n\n    return (\n        <Box\n            sx={{\n                display: \"flex\",\n                alignItems: \"center\",\n                gap: 1, // Spacing between elements\n                padding: 1,\n                backgroundColor: \"background.paper\",\n                borderTop: \"1px solid\",\n                borderColor: \"divider\",\n            }}\n        >\n            <TextField\n                fullWidth\n                variant=\"outlined\"\n                placeholder=\"Type a message...\"\n                value={message}\n                onChange={(e) => setMessage(e.target.value)}\n                onKeyDown={(e) => e.key === \"Enter\" && handleSend()}\n            />\n            <IconButton color=\"primary\" onClick={handleSend}>\n                <SendIcon/>\n            </IconButton>\n        </Box>\n    );\n};\n\nexport default ChatInputBar;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAGC,QAAQ,QAAO,OAAO;AACrC,SAAQC,GAAG,EAAEC,SAAS,EAAEC,UAAU,QAAO,eAAe;AACxD,OAAOC,QAAQ,MAAM,0BAA0B;AAC/C,SAAQC,SAAS,QAAO,iCAAiC;AAEzD,SAAQC,OAAO,QAAO,4BAA4B;AAClD,SAAQC,QAAQ,QAAO,sBAAsB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAQ9C,eAAeC,QAAQA,CAACC,IAAY,EAAEC,KAAa,EAAEC,IAAmB,EAAEC,OAGzE,EAAEC,MAAkB,EAAEC,QAAa,GAAG,GAAGT,QAAQ,eAAeI,IAAI,WAAW,EAAEM,MAAc,GAAG,MAAM,EAAE;EACvG,IAAI;IAEA,MAAMC,GAAgB,GAAG;MACrBD,MAAM,EAAEA,MAAM;MACdE,OAAO,EAAE;QACL,eAAe,EAAE,UAAUP,KAAK,EAAE;QAClC,cAAc,EAAE,kBAAkB;QAClC,sBAAsB,EAAEQ,MAAM,CAACP,IAAI;MACvC;IACJ,CAAC;IAED,IAAII,MAAM,KAAK,MAAM,IAAIA,MAAM,KAAK,KAAK,EAAE;MACvCC,GAAG,CAACG,IAAI,GAAGC,IAAI,CAACC,SAAS,CAACT,OAAO,CAAC;IACtC;IAIA,MAAMU,QAAQ,GAAG,MAAMC,KAAK,CAACT,QAAQ,EAAE;MACnCC,MAAM,EAAEA,MAAM;MACdE,OAAO,EAAE;QACL,eAAe,EAAE,UAAUP,KAAK,EAAE;QAClC,cAAc,EAAE,kBAAkB;QAClC,sBAAsB,EAAEQ,MAAM,CAACP,IAAI;MACvC,CAAC;MACDQ,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACT,OAAO;IAChC,CAAC,CAAC;IAEF,IAAIU,QAAQ,CAACE,MAAM,KAAK,GAAG,EAAE;MACzBC,OAAO,CAACC,IAAI,CAAC,+CAA+C,CAAC;MAE7D,IAAIf,IAAI,KAAK,IAAI,EAAE;QACfE,MAAM,CAAC,CAAC;MACZ;MAEA,MAAM,IAAIc,KAAK,CAAC,+CAA+C,CAAC;IACpE;IAEA,IAAI,CAACL,QAAQ,CAACM,EAAE,EAAE;MACd,MAAM,IAAID,KAAK,CAAC,UAAUL,QAAQ,CAACO,UAAU,EAAE,CAAC;IACpD;IAEA,OAAO,MAAMP,QAAQ,CAACQ,IAAI,CAAC,CAAC;EAChC,CAAC,CAAC,OAAOC,KAAK,EAAE;IACZN,OAAO,CAACM,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;IAC/C,OAAO,IAAI;EACf;AACJ;AAEA,MAAMC,YAAyC,GAAGA,CAAC;EAACvB,IAAI;EAAEwB;AAAc,CAAC,KAAK;EAAAC,EAAA;EAC1E,MAAM,CAACC,OAAO,EAAEC,UAAU,CAAC,GAAGtC,QAAQ,CAAC,EAAE,CAAC;EAC1C,MAAM;IAACuC;EAAW,CAAC,GAAGlC,SAAS,CAAC,CAAC;EACjC,MAAM;IAACQ,IAAI;IAAED,KAAK;IAAEG;EAAM,CAAC,GAAGT,OAAO,CAAC,CAAC;EAEvC,MAAMkC,UAAU,GAAG,MAAAA,CAAA,KAAY;IAC3B,IAAIH,OAAO,CAACI,IAAI,CAAC,CAAC,KAAK,EAAE,EAAE;MAEvB,MAAMC,IAAgB,GAAG;QAACC,KAAK,EAAEhC,IAAI;QAAEiC,IAAI,EAAE/B,IAAI;QAAEgC,KAAK,EAAEhC,IAAI;QAAEiC,IAAI,EAAET;MAAO,CAAC;MAC9EE,WAAW,CAACG,IAAI,CAAC;MACjBP,cAAc,CAAC,CAAC;MAChBG,UAAU,CAAC,EAAE,CAAC;MAGd,MAAMxB,OAAO,GAAG;QACZgC,IAAI,EAAET,OAAO;QACbU,IAAI,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;MACjC,CAAC;MAGD,OAAO,MAAMvC,QAAQ,CAACC,IAAI,EAAEC,KAAK,EAAEC,IAAI,EAAEC,OAAO,EAAEC,MAAM,CAAC;IAG7D;EAGJ,CAAC;EAGD,oBACIN,OAAA,CAACR,GAAG;IACAiD,EAAE,EAAE;MACAC,OAAO,EAAE,MAAM;MACfC,UAAU,EAAE,QAAQ;MACpBC,GAAG,EAAE,CAAC;MAAE;MACRC,OAAO,EAAE,CAAC;MACVC,eAAe,EAAE,kBAAkB;MACnCC,SAAS,EAAE,WAAW;MACtBC,WAAW,EAAE;IACjB,CAAE;IAAAC,QAAA,gBAEFjD,OAAA,CAACP,SAAS;MACNyD,SAAS;MACTC,OAAO,EAAC,UAAU;MAClBC,WAAW,EAAC,mBAAmB;MAC/BC,KAAK,EAAEzB,OAAQ;MACf0B,QAAQ,EAAGC,CAAC,IAAK1B,UAAU,CAAC0B,CAAC,CAACC,MAAM,CAACH,KAAK,CAAE;MAC5CI,SAAS,EAAGF,CAAC,IAAKA,CAAC,CAACG,GAAG,KAAK,OAAO,IAAI3B,UAAU,CAAC;IAAE;MAAA4B,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACvD,CAAC,eACF9D,OAAA,CAACN,UAAU;MAACqE,KAAK,EAAC,SAAS;MAACC,OAAO,EAAEjC,UAAW;MAAAkB,QAAA,eAC5CjD,OAAA,CAACL,QAAQ;QAAAgE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAC;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACZ,CAAC;AAEd,CAAC;AAACnC,EAAA,CAtDIF,YAAyC;EAAA,QAErB7B,SAAS,EACDC,OAAO;AAAA;AAAAoE,EAAA,GAHnCxC,YAAyC;AAwD/C,eAAeA,YAAY;AAAC,IAAAwC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}